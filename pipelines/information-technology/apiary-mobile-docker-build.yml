---
template: oci-build

repository:
  name: apiary-mobile
  github: github.com
  main_branch: main

base_image:
  repository: mingc/android-build-box
  tag: 1.24.0
  icon: docker

resource_types:
- name: github-webhook
  defaults:
    resources:
      mjackets-api: (( grab webhook_configuration ))

resources:

- (( merge on name ))

- name: (( grab repository.name ))
  source:
    paths:
    - ci/dockerfiles/Dockerfile

- name: pull-request
  source:
    paths:
    - ci/dockerfiles/Dockerfile

tasks:

  build_image:
    params:
      CONTEXT: source/ci/mjackets-build
